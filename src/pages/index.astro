---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Menu from '../components/Menu.astro';
import Carta from '../components/Carta.astro';
import Descubre from '../components/Descubre.astro';
import Beneficios from '../components/Beneficios.astro';
import Nosotros from '../components/Nosotros.astro';
import Footer from '../components/Footer.astro';
---

<Layout>
    <Header/>
    <main>
        <Menu/>
        <Carta/>
        <Descubre/>
        <Beneficios/>
        <Nosotros/>
        <Footer/>
    </main>
</Layout>

<script>
    function smoothScroll(target: HTMLElement | null, duration: number) {
        if (!target) return; 

        let targetPosition = target.getBoundingClientRect().top + window.scrollY - 68;
        let startPosition = window.scrollY;
        let distance = targetPosition - startPosition;
        let startTime: number | null = null;

        function animation(currentTime: number) {
            if (startTime === null) startTime = currentTime;
            let timeElapsed = currentTime - startTime;
            let run = ease(timeElapsed, startPosition, distance, duration);
            window.scrollTo(0, run);
            if (timeElapsed < duration) requestAnimationFrame(animation);
        }

        function ease(t: number, b: number, c: number, d: number) {
            t /= d / 2;
            if (t < 1) return c / 2 * t * t + b;
            t--;
            return -c / 2 * (t * (t - 2) - 1) + b;
        }

        requestAnimationFrame(animation);
    }

    document.getElementById("scroll-inicio")?.addEventListener("click", function(event) {
        event.preventDefault();
        let target = document.getElementById("background"); 
        smoothScroll(target, 800);
    });

    document.getElementById("scroll-menu")?.addEventListener("click", function(event) {
        event.preventDefault();
        let target = document.getElementById("menu");
        smoothScroll(target, 800);
    });

    document.getElementById("scroll-nosotros")?.addEventListener("click", function(event) {
        event.preventDefault();
        let target = document.getElementById("nosotros");
        smoothScroll(target, 800);
    });

    document.getElementById("scroll-ubicanos")?.addEventListener("click", function(event) {
        event.preventDefault();
        let target = document.getElementById("ubicacion");
        smoothScroll(target, 800);
    });

    document.getElementById("scroll-carta")?.addEventListener("click", function(event) {
        event.preventDefault();
        let target = document.getElementById("carta");
        smoothScroll(target, 800);
    });

    document.addEventListener("DOMContentLoaded", function () {
        const nav = document.querySelector("nav");

        if (!nav) return;

        function handleScroll() {
            if (window.scrollY > 10) {
                nav?.classList.add("scrolled");
            } else {
                nav?.classList.remove("scrolled");
            }
        }

        handleScroll();

        window.addEventListener("scroll", handleScroll);
    });
</script>